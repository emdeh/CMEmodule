# User Documentation -  UserListFromRIDBrute Module

## Overview
The `UserListFromRIDBrute` module for CrackMapExec (CME) is designed to process output from the `--rid-brute` flag and extract usernames where `sidtype` is 'SidTypeUser'. This functionality is crucial when working with domain user accounts, particularly when `NULL` Authentication is enabled.

## Functionality
The `--rid-brute` flag functions by enumerating domain objects through their Relative Identifiers (RID), which are unique to each account within a Windows domain. The process involves:

1. Starting with well-known RIDs such as 500, typically the default administrator account.
2. Brute-forcing through a range of RIDs.
3. Querying the domain controller to translate RIDs to corresponding usernames.

By default, it works up to RID 4000, which can be altered with the `--rid-brute [MAX_RID]` syntax.

# Example of Usage
```bash
crackmapexec smb $TargetIP -u '' -p '' --rid-brute 8000 > ridOutput.txt
```

The resulting output file named `ridOutput.txt` will contain the raw data needed for further processing. This will include account objects and other AD objects

## Output Format
The output from the `--rid-brute` command is structured in JSON format, with each object containing keys for `rid`, `domain`, `username`, and `sidtype`. Here is an example snippet from an output file:

```json
[
    {
        "rid": 498,
        "domain": "%DOMAIN%",
        "username": "Enterprise Read-only Domain Controllers",
        "sidtype": "SidTypeGroup"
    },
    {
        "rid": 500,
        "domain": "OrgDomainName",
        "username": "Administrator",
        "sidtype": "SidTypeUser"
    },
]
```
## Preparing Output for ASREPRoast

To prepare the raw data for identifying ASREPRoastable accounts, the information must be filtered to include only the objects where `sidtype` equals 'SidTypeUser'. 

The [`userListFromRIDBrute.py`](userListFromRIDBrute.py) script, used as a custom module in CrackMapExec, serves this purpose by processing the output file.

## Using the Module

After obtaining the output from the `--rid-brute` command, you can use the `userListFromRIDBrute.py` script as follows:

1. Place the `userListFromRIDBrute.py` script into the CME custom modules directory.
2. Run the module by pointing it to the `ridOutput.txt` file:

```bash
crackmapexec smb $TargetIP -u '' -p '' -M userListFromRIDBrute -o FILE=<rid_brute_output_file>
```

The script will parse the `ridOutput.txt` file, extracting usernames where `sidtype` is 'SidTypeUser', and output them for further use.

### Identifying ASREPRoastable Accounts

With a cleaned list of usernames, you can proceed to locate ASREPRoastable accounts with the following command:

```bash
crackmapexec ldap $HOSTIP -u users.txt -p '' --asreproast asreproast.out --kdcHost OrgDomainName
```

Here, `users.txt` should be the file generated by the `userListFromRIDBrute.py` module, containing only the usernames.

## Conclusion

The `UserListFromRIDBrute` module refines the results of a `--rid-brute` enumeration into a concise list of usernames. This list is critical for subsequent enumeration, such as checking for ASREPRoastable accounts.

# Technical overview
- [Technical documentation](TECHNICAL-DOCUMENTATION.md)

# Contributing
Contributions to Nmap Assistant are welcome! Feel free to fork the repository, make your changes, and submit a pull request.